
# Smile_Sq 運用規定書

**1. 概要**
本ドキュメントは、運動エネルギーと表情筋収縮の同期性を検証するための実験的インターフェース "Smile_Sq" の仕様について記述する。
本システムは、被験者の下肢運動（スクワット）と顔面形状（笑顔）を常時監視し、両条件が規定閾値を満たした瞬間のみを「有効な活動」として記録するよう設計されている。

**2. 動作要件**
実験環境の構築には以下のリソースが必要となる。

*   **Runtime**: Node.js v20 以上
*   **Sensor**: 映像入力デバイス（Webカメラ）
*   **Environment**: Google MediaPipe が稼働する最新のブラウザ環境

**3. 起動シーケンス**
担当オペレーターは以下の手順にてシステムを初期化すること。

```bash
# リソース展開
npm install

# 観測プロセス開始
npm run dev
```

接続先: `http://localhost:3000`
※ 初回起動時、監視カメラへのアクセス権限譲渡が要求される。実験遂行のためこれを承認すること。

**4. 監視パラメータ**
本システムは以下の生体信号をリアルタイムに処理する。

**4.1. 負荷運動 (Kinetic Load)**
MoveNet モデルにより被験者の全身骨格を追跡する。
膝関節角度が 100度未満 (Down) から 160度以上 (Up) へ推移した一連の動作を、1単位の運動としてカウントする。

**4.2. 表情強制 (Expression Enforcement)**
Face Mesh モデルにより顔面の形状係数を解析する。
スクワット動作中、被験者の表情は常に「笑顔 (Smile)」であることが求められる。
システムは Mouth Aspect Ratio (MAR) 係数が 0.45 を超過している状態のみを「正常」と判定し、それ以外については視覚的警告を行う場合がある。

**4.3. 同期プロトコル**
本システムの特異点は、上記 4.1 と 4.2 の同時成立を求めている点にある。
表情筋の収縮を伴わない運動は、システム上で「無意味なデータ」として扱われる可能性がある点に留意されたい。

**5. 運用上の注意**
*   **GPU異常**: 特定の環境下において、画像処理ユニットの初期化に失敗する事例が報告されている。その場合、CPUによる低速処理モードへ自動移行する。
*   **身体的影響**: 長時間のセッションにより被験者に重篤な筋肉疲労、または表情筋の痙攣が発生した場合でも、システム側での停止措置は行われない。各個人の判断で終了すること。

**6. 技術詳細**
*   **Core**: Next.js 16
*   **Vision Engine**: MediaPipe Tasks Vision
*   **Language**: TypeScript

以上
