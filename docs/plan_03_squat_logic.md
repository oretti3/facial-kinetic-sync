# 実装計画書 - スクワット判定ロジック

## ゴール
Pose Detection (MoveNet) の骨格データを使用して、スクワットの回数を自動カウントする機能を実装する。
膝の角度と垂直方向の動きを追跡し、正しい動作が行われたかを判定する。

## 変更内容

### ロジック実装 (`CameraView.tsx`)
- **使用するキーポイント**:
  - 腰 (Hip): 左(11) / 右(12)
  - 膝 (Knee): 左(13) / 右(14)
  - 足首 (Ankle): 左(15) / 右(16)
  
- **判定アルゴリズム**:
  1. **3点間の角度計算**: 腰-膝-足首 の角度を算出する。
  2. **閾値の設定**:
     - **立ち状態 (UP)**: 膝の角度 > 160度
     - **しゃがみ状態 (DOWN)**: 膝の角度 < 100度 (※調整可能)
  3. **ステートマシン (状態遷移)**:
     - 現在 `UP` → 角度が閾値以下 → `DOWN` へ遷移
     - 現在 `DOWN` → 角度が閾値以上 → `UP` へ遷移し、**カウント +1**

- **フィードバック表示**:
  - 画面上に現在の「スクワット回数」を表示。
  - デバッグ用に現在の状態（UP/DOWN）と膝の角度を表示。

### UI更新
- テキストオーバーレイを追加し、視認性を高める。
- 必要に応じて、角度を可視化するガイドラインを描画。

## 検証計画

### 動作確認手順
1. カメラの前に立ち、全身が映るようにする。
2. その場でスクワットを行う（膝が曲がるまで腰を落とす）。
3. 状態が "DOWN" に変わることを確認。
4. 元の立ち姿勢に戻る。
5. カウントが **1** 増えることを確認。
6. これを連続で行い、誤検知がないか確認する。
